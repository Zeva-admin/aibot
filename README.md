──────────────────────────────────────────────────────────────
1) Возможности
──────────────────────────────────────────────────────────────

Пользователи:
- 🛒 Каталог: Оружие / Броня / Сопровождения
- 📄 Список товаров с пагинацией + страница товара (вперёд/назад)
- ➕ Добавление в корзину (кнопкой или по ID)
- 🧺 Корзина: просмотр, сумма, очистка
- ✅ Оформление заказа
- 📞 Показ номера для оплаты
- 📷 Отправка фото/скриншота оплаты в чат бота
- ⚖️ Оспаривание отклонённого заказа (через поддержку или через бота)

Админы:
- 🔐 Вход в админку: /add (пароль из config.json)
- 📦 Товары (weapon/armor): добавить/удалить/цена/описание
- 🧭 Сопровождения (escort): добавить/удалить/цена/описание
- ⚙️ Настройки: пароль, номер оплаты, username поддержки, очистка заказов
- 📢 Рассылка
- 📊 Статистика
- 📜 Логи (1h/24h/7d/все)
- 🧠 Проверка оплаты по фото (Groq Vision): обычная / подробная
- 🧰 ИИ‑оператор: план действий (JSON) + выполнение после подтверждения

──────────────────────────────────────────────────────────────
2) Технологии
──────────────────────────────────────────────────────────────
- Python 3.10+
- pyTelegramBotAPI
- Groq SDK (LLM + Vision)
- Flask (эндпоинты / и /health)

──────────────────────────────────────────────────────────────
3) Установка
──────────────────────────────────────────────────────────────
pip install pyTelegramBotAPI groq flask

──────────────────────────────────────────────────────────────
4) Переменные окружения (обязательно)
──────────────────────────────────────────────────────────────
BOT_TOKEN     — токен Telegram от @BotFather
GROQ_API_KEY  — ключ Groq API

Linux/macOS:
export BOT_TOKEN="123:ABC..."
export GROQ_API_KEY="gsk_..."

Windows PowerShell:
setx BOT_TOKEN "123:ABC..."
setx GROQ_API_KEY "gsk_..."

──────────────────────────────────────────────────────────────
5) Запуск локально
──────────────────────────────────────────────────────────────
python bot.py

Flask эндпоинты:
- GET /       -> OK
- GET /health -> OK

──────────────────────────────────────────────────────────────
6) Данные и “память” (JSON файлы)
──────────────────────────────────────────────────────────────
При первом запуске создаются:
- config.json      (пароль админки, номер оплаты, username поддержки и др.)
- products.json    (товары/услуги)
- users.json       (пользователи, корзины, админ‑флаг)
- orders.json      (заказы)
- logs.json        (логи/ошибки)
- ai_memory.json   (задел под память)

ВАЖНО ПРО Render/другие PaaS:
- Файлы внутри контейнера часто НЕ сохраняются при redeploy.
- Поэтому товары/заказы могут “исчезать” после обновления кода.
Решения:
- Persistent Disk (если доступен)
- PostgreSQL (рекомендуется)
- Внешнее хранилище/бэкапы (как дополнение)

──────────────────────────────────────────────────────────────
7) Команды бота
──────────────────────────────────────────────────────────────
/start  — главное меню
/menu   — главное меню
/add    — вход в админку (по паролю)

──────────────────────────────────────────────────────────────
8) Как пользоваться (коротко)
──────────────────────────────────────────────────────────────
Покупатель:
1) /start
2) 🛒 Магазин или 🧭 Сопровождения
3) Открыть товар → ➕ в корзину
4) 🧺 Корзина → ✅ Оформить заказ
5) 📞 Оплата → оплатить по номеру
6) Отправить фото оплаты в чат бота

Админ:
1) /add → пароль → админ‑меню
2) Получить заказ с фото → проверить (ИИ) / написать / отклонить

──────────────────────────────────────────────────────────────
9) Формат товара (products.json)
──────────────────────────────────────────────────────────────
Пример:
{
  "id": 1,
  "title": "AKM Deluxe",
  "type": "weapon",        # weapon | armor | escort
  "category": "Штурмовые",
  "price": 50,
  "description": "..."
}

──────────────────────────────────────────────────────────────
10) Проверка оплаты по фото (Groq Vision)
──────────────────────────────────────────────────────────────
Vision модель:
- meta-llama/llama-4-scout-17b-16e-instruct

Проверка пытается определить:
- реальное изображение или подозрительное/монтаж/ИИ
- видимость суммы, валюты, получателя, статуса операции, даты/времени

Примечание:
- результат ИИ — подсказка, финальное решение принимает администратор.

──────────────────────────────────────────────────────────────
11) Безопасность (обязательно)
──────────────────────────────────────────────────────────────
- Не коммитьте токены/ключи в GitHub.
- Если они уже были опубликованы:
  - BotFather: /revoke (новый BOT_TOKEN)
  - Groq: перевыпустить API key
- Смените пароль админки на сложный.
- Желательно: whitelist админов по user_id и лимит попыток пароля.

──────────────────────────────────────────────────────────────
12) Лицензия
──────────────────────────────────────────────────────────────
Добавьте лицензию по необходимости (MIT/Apache-2.0 и т.п.).
